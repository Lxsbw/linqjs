"use strict";class Linq{constructor(e=[]){this._elements=e}add(e){this._elements.push(e)}append(e){this.add(e)}prepend(e){this._elements.unshift(e)}addRange(e){this._elements.push(...e)}aggregate(e,t){return this._elements.reduce(e,t)}all(e){return this._elements.every(e)}any(e){return e?this._elements.some(e):0<this._elements.length}average(e){return Tools.calcNumDiv(this.sum(e),this.count())}cast(){return new Linq(this._elements)}clear(){this._elements.length=0}concat(e){return new Linq(this._elements.concat(e.toArray()))}contains(t){return this.any(e=>e===t)}count(e){return e?this.where(e).count():this._elements.length}defaultIfEmpty(e){return this.count()?this:new Linq([e])}distinct(){return this.where((t,e,n)=>(Tools.isObject(t)?n.findIndex(e=>Tools.equal(e,t)):n.indexOf(t))===e)}distinctBy(e){const r=this.groupBy(e);return new Linq(r).select(e=>e.key).toArray().reduce(function(e,t){var n=new Linq(r).firstOrDefault(e=>Tools.equal(e.key,t));return e.add(n.elements[0]),e},new Linq)}distinctMap(e){return(e?this.select(e):this).distinct()}elementAt(e){if(e<this.count()&&0<=e)return this._elements[e];throw new Error("ArgumentOutOfRangeException: index is less than 0 or greater than or equal to the number of elements in source.")}elementAtOrDefault(e){return e<this.count()&&0<=e?this._elements[e]:void 0}except(t){return this.where(e=>!t.contains(e))}first(e){if(this.count())return e?this.where(e).first():this._elements[0];throw new Error("InvalidOperationException: The source sequence is empty.")}firstOrDefault(e){return this.count(e)?this.first(e):void 0}forEach(e){return this._elements.forEach(e)}groupBy(s,i=e=>e){return this.aggregate(function(e,t){const n=s(t);var r=new Linq(e).firstOrDefault(e=>Tools.equal(e.key,n)),t=i(t);return r?(r.elements.push(t),r.count++):(r={key:n,count:1,elements:[t]},e.push(r)),e},[])}groupJoin(e,n,r,s){return this.select(t=>s(t,e.where(e=>n(t)===r(e))))}indexOf(e){return this._elements.indexOf(e)}insert(e,t){if(e<0||e>this._elements.length)throw new Error("Index is out of range.");this._elements.splice(e,0,t)}intersect(t){return this.where(e=>t.contains(e))}join(e,n,r,s){return this.selectMany(t=>e.where(e=>r(e)===n(t)).select(e=>s(t,e)))}last(e){if(this.count())return e?this.where(e).last():this._elements[this.count()-1];throw Error("InvalidOperationException: The source sequence is empty.")}lastOrDefault(e){return this.count(e)?this.last(e):void 0}max(e){return Math.max(...this._elements.map(e||(e=>e)))}min(e){return Math.min(...this._elements.map(e||(e=>e)))}ofType(t){let n;switch(t){case Number:n="number";break;case String:n="string";break;case Boolean:n=typeof!0;break;case Function:n="function";break;default:n=null}return(null===n?this.where(e=>e instanceof t):this.where(e=>typeof e===n)).cast()}orderBy(e,t=Tools.keyComparer(e,!1)){return new OrderedList(Tools.cloneDeep(this._elements),t)}orderByDescending(e,t=Tools.keyComparer(e,!0)){return new OrderedList(Tools.cloneDeep(this._elements),t)}thenBy(e){return this.orderBy(e)}thenByDescending(e){return this.orderByDescending(e)}remove(e){return-1!==this.indexOf(e)&&(this.removeAt(this.indexOf(e)),!0)}removeAll(e){return this.where(Tools.negate(e))}removeAt(e){this._elements.splice(e,1)}reverse(){return new Linq(this._elements.reverse())}select(e){return new Linq(this._elements.map(e))}selectMany(r){return this.aggregate((e,t,n)=>(e.addRange(this.select(r).elementAt(n).toArray()),e),new Linq)}sequenceEqual(t){return this.all(e=>t.contains(e))}single(e){if(1!==this.count(e))throw new Error("The collection does not contain exactly one element.");return this.first(e)}singleOrDefault(e){return this.count(e)?this.single(e):void 0}skip(e){return new Linq(this._elements.slice(Math.max(0,e)))}skipLast(e){return new Linq(this._elements.slice(0,-Math.max(0,e)))}skipWhile(t){return this.skip(this.aggregate(e=>t(this.elementAt(e))?++e:e,0))}sum(e){return e?this.select(e).sum():this.aggregate((e,t)=>Tools.calcNum(e,+t),0)}take(e){return new Linq(this._elements.slice(0,Math.max(0,e)))}takeLast(e){return new Linq(this._elements.slice(-Math.max(0,e)))}takeWhile(t){return this.take(this.aggregate(e=>t(this.elementAt(e))?++e:e,0))}toArray(){return this._elements}toDictionary(r,s){return this.aggregate((e,t,n)=>(e.add({Key:this.select(r).elementAt(n),Value:s?this.select(s).elementAt(n):t}),e),new Linq)}toList(){return this}toLookup(e,t){return this.groupBy(e,t)}union(e){return this.concat(e).distinct()}where(e){return new Linq(this._elements.filter(e))}zip(n,r){return n.count()<this.count()?n.select((e,t)=>r(this.elementAt(t),e)):this.select((e,t)=>r(e,n.elementAt(t)))}}class OrderedList extends Linq{constructor(e,t){super(e),this._comparer=t,this._elements.sort(this._comparer)}thenBy(e){return new OrderedList(this._elements,Tools.composeComparers(this._comparer,Tools.keyComparer(e,!1)))}thenByDescending(e){return new OrderedList(this._elements,Tools.composeComparers(this._comparer,Tools.keyComparer(e,!0)))}}const Tools={isObject(e){return!!e&&"object"==typeof e},equal(e,t){var n,r,s;return e===t||typeof e==typeof t&&(this.isObject(e)&&this.isObject(t)?(n=[e,t].map(e=>e.constructor))[0]===n[1]&&(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():(n=Object.entries(e),r=Object.entries(t),n.length===r.length&&(s=(e,n)=>e.every(([e,t])=>this.isObject(t)?this.equal(n[e],t):n[e]===t))(n,t)&&s(r,e))):e===t)},negate(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return!n.apply(void 0,e)}},composeComparers(n,r){return(e,t)=>n(e,t)||r(e,t)},keyComparer(s,i){return(e,t)=>{var n,r,e=s(e),t=s(t);return this.isString(e)&&this.isString(t)?(r=t,0<(n=e).localeCompare(r)?i?-1:1:0<r.localeCompare(n)?i?1:-1:0):(r=t)<(n=e)?i?-1:1:n<r?i?1:-1:0}},calcNum(e,t){var n,r;return this.isNum(e)&&this.isNum(t)?({mult:n,place:r}=this.calcMultiple(e,t),Number(((e*n+t*n)/n).toFixed(r))):0},calcNumDiv(e,t){return e/t},isNum(e){return"number"==typeof e&&!isNaN(e)},isString(e){return"string"==typeof e&&e.constructor===String},calcMultiple(e,t){e=e.toString().split("."),t=t.toString().split("."),e=1<e.length?e[1].length:0,t=1<t.length?t[1].length:0;return{mult:Math.pow(10,Math.max(e,t)),place:t<=e?e:t}},cloneDeep(e){if("function"==typeof structuredClone)return structuredClone(e);let t;if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return(t=new Date).setTime(e.getTime()),t;if(e instanceof RegExp)return t=e;if(e instanceof Array){for(var n in t=[],e)t.push(this.cloneDeep(e[n]));return t}if(e instanceof Object){for(var r in t={},e)e.hasOwnProperty(r)&&(t[r]=this.cloneDeep(e[r]));return t}throw new Error("Unable to copy param! Its type isn't supported.")}};"undefined"!=typeof module?(exports="undefined"!=typeof exports?module.exports=Linq:exports).Linq=Linq:window.Linq=Linq;