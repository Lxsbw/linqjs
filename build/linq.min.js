"use strict";class Linq{constructor(e){this._elements=e=void 0===e?[]:e}add(e){this._elements.push(e)}append(e){this.add(e)}prepend(e){this._elements.unshift(e)}addRange(e){var t;(t=this._elements).push.apply(t,e)}aggregate(e,t){return this._elements.reduce(e,t)}all(e){return this._elements.every(e)}any(e){return e?this._elements.some(e):0<this._elements.length}average(e){return tools.calcNumDiv(this.sum(e),this.count())}cast(){return new Linq(this._elements)}clear(){this._elements.length=0}concat(e){return new Linq(this._elements.concat(e.toArray()))}contains(t){return this.any(function(e){return e===t})}count(e){return e?this.where(e).count():this._elements.length}defaultIfEmpty(e){return this.count()?this:new Linq([e])}distinct(){return this.where(function(t,e,n){return(tools.isObj(t)?n.findIndex(function(e){return tools.equal(e,t)}):n.indexOf(t))===e})}distinctBy(e){var r=this.groupBy(e);return new Linq(r).select(e=>e.key).toArray().reduce(function(e,t){var n=new Linq(r).firstOrDefault(e=>tools.equal(e.key,t));return e.add(n.elements[0]),e},new Linq)}distinctMap(e){return(e?this.select(e):this).distinct()}elementAt(e){if(e<this.count()&&0<=e)return this._elements[e];throw new Error("ArgumentOutOfRangeException: index is less than 0 or greater than or equal to the number of elements in source.")}elementAtOrDefault(e){return e<this.count()&&0<=e?this._elements[e]:void 0}except(t){return this.where(function(e){return!t.contains(e)})}first(e){if(this.count())return e?this.where(e).first():this._elements[0];throw new Error("InvalidOperationException: The source sequence is empty.")}firstOrDefault(e){return this.count(e)?this.first(e):void 0}forEach(e){return this._elements.forEach(e)}groupBy(s,i){void 0===i&&(i=function(e){return e});return this.aggregate(function(e,t){var n=s(t),r=new Linq(e).firstOrDefault(e=>tools.equal(e.key,n)),t=i(t);return r?(r.elements.push(t),r.count++):e.push({key:n,count:1,elements:[t]}),e},[])}groupJoin(e,n,r,s){return this.select(function(t){return s(t,e.where(function(e){return n(t)===r(e)}))})}indexOf(e){return this._elements.indexOf(e)}insert(e,t){if(e<0||e>this._elements.length)throw new Error("Index is out of range.");this._elements.splice(e,0,t)}intersect(t){return this.where(function(e){return t.contains(e)})}join(e,n,r,s){var i;return i=function(t){return e.where(function(e){return r(e)===n(t)}).select(function(e){return s(t,e)})},this.aggregate((e,t,n)=>(e.addRange(this.select(i).elementAt(n).toArray()),e),new Linq)}last(e){if(this.count())return e?this.where(e).last():this._elements[this.count()-1];throw Error("InvalidOperationException: The source sequence is empty.")}lastOrDefault(e){return this.count(e)?this.last(e):void 0}max(e){return Math.max.apply(Math,this._elements.map(e||function(e){return e}))}min(e){return Math.min.apply(Math,this._elements.map(e||function(e){return e}))}ofType(t){var n;switch(t){case Number:n="number";break;case String:n="string";break;case Boolean:n=typeof!0;break;case Function:n="function";break;default:n=null}return(null===n?this.where(function(e){return e instanceof t}):this.where(function(e){return typeof e===n})).cast()}orderBy(e,t){return void 0===t&&(t=tools.keyComparer(e,!1)),new OrderedList(tools.cloneDeep(this._elements),t)}orderByDescending(e,t){return void 0===t&&(t=tools.keyComparer(e,!0)),new OrderedList(tools.cloneDeep(this._elements),t)}thenBy(e){return this.orderBy(e)}thenByDescending(e){return this.orderByDescending(e)}remove(e){return-1!==this.indexOf(e)&&(this.removeAt(this.indexOf(e)),!0)}removeAll(e){return this.where(tools.negate(e))}removeAt(e){this._elements.splice(e,1)}reverse(){return new Linq(this._elements.reverse())}select(e){return new Linq(this._elements.map(e))}selectMany(r){var s=this;return this.aggregate(function(e,t,n){return e.addRange(s.select(r).elementAt(n).toArray()),e},new Linq)}sequenceEqual(t){return this.all(function(e){return t.contains(e)})}single(e){if(1!==this.count(e))throw new Error("The collection does not contain exactly one element.");return this.first(e)}singleOrDefault(e){return this.count(e)?this.single(e):void 0}skip(e){return new Linq(this._elements.slice(Math.max(0,e)))}skipLast(e){return new Linq(this._elements.slice(0,-Math.max(0,e)))}skipWhile(t){var n=this;return this.skip(this.aggregate(function(e){return t(n.elementAt(e))?++e:e},0))}sum(e){return e?this.select(e).sum():this.aggregate(function(e,t){return tools.calcNum(e,+t)},0)}take(e){return new Linq(this._elements.slice(0,Math.max(0,e)))}takeLast(e){return new Linq(this._elements.slice(-Math.max(0,e)))}takeWhile(t){var n=this;return this.take(this.aggregate(function(e){return t(n.elementAt(e))?++e:e},0))}toArray(){return this._elements}toDictionary(r,s){var i=this;return this.aggregate(function(e,t,n){return e[i.select(r).elementAt(n).toString()]=s?i.select(s).elementAt(n):t,e.add({Key:i.select(r).elementAt(n),Value:s?i.select(s).elementAt(n):t}),e},new Linq)}toList(){return this}toLookup(e,t){return this.groupBy(e,t)}union(e){return this.concat(e).distinct()}where(e){return new Linq(this._elements.filter(e))}zip(n,r){var s=this;return n.count()<this.count()?n.select(function(e,t){return r(s.elementAt(t),e)}):this.select(function(e,t){return r(e,n.elementAt(t))})}}class OrderedList extends Linq{constructor(e,t){super(e),this._comparer=t,this._elements.sort(this._comparer)}thenBy(e){return new OrderedList(this._elements,tools.composeComparers(this._comparer,tools.keyComparer(e,!1)))}thenByDescending(e){return new OrderedList(this._elements,tools.composeComparers(this._comparer,tools.keyComparer(e,!0)))}}const tools={isObj(e){return!!e&&"object"==typeof e},equal(e,n){return e===n||typeof e==typeof n&&(e instanceof Object?Object.entries(e).every(e=>{var t=e[0],e=e[1];return this.isObj(e)?this.equal(n[t],e):n[t]===e}):e===n)},negate(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return!n.apply(void 0,e)}},composeComparers(n,r){return function(e,t){return n(e,t)||r(e,t)}},keyComparer(s,i){return function(e,t){var n,r,e=s(e),t=s(t);return tools.isString(e)&&tools.isString(t)?(r=t,0<(n=e).localeCompare(r)?i?-1:1:0<r.localeCompare(n)?i?1:-1:0):(r=t)<(n=e)?i?-1:1:n<r?i?1:-1:0}},calcNum(e,t){var n,r;return this.isNum(e)&&this.isNum(t)?({mult:n,place:r}=this.calcMultiple(e,t),Number(((e*n+t*n)/n).toFixed(r))):0},calcNumDiv(e,t){return e/t},isNum(e){return"number"==typeof e&&!isNaN(e)},isString(e){return"string"==typeof e&&e.constructor===String},calcMultiple(e,t){e=e.toString().split("."),t=t.toString().split("."),e=1<e.length?e[1].length:0,t=1<t.length?t[1].length:0;return{mult:Math.pow(10,Math.max(e,t)),place:t<=e?e:t}},cloneDeep(e){let t;if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return(t=new Date).setTime(e.getTime()),t;if(e instanceof RegExp)return t=e;if(e instanceof Array){for(var n in t=[],e)t.push(this.cloneDeep(e[n]));return t}if(e instanceof Object){for(var r in t={},e)e.hasOwnProperty(r)&&(t[r]=this.cloneDeep(e[r]));return t}throw new Error("Unable to copy param! Its type isn't supported.")}};"undefined"!=typeof module?(exports="undefined"!=typeof exports?module.exports=Linq:exports).Linq=Linq:window.Linq=Linq;